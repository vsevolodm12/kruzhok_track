Введение
Для работы с API Zenclass вам понадобится собственная онлайн-школа. Если у вас её ещё нет, зарегистрируйтесь на сайте zenclass.ru. Во время пробного периода вы можете использовать API без ограничений.
По всем вопросам работы API обращайтесь в чат поддержки или на почту support@zenclass.ru.
Начало работы
Чтобы взаимодействовать с API, вам понадобится выпустить токен. Это можно сделать в настройках вашей школы (раздел "Основные настройки", вкладка "API").
Количество выпущенных токенов не ограничено. Мы рекомендуем выпускать отдельные токены для разных интеграций. Обратите внимание, что к токену следует относиться как к паролю: не сообщайте его посторонним, т.к. с использованием вашего токена можно вносить изменения в ваш аккаунт Zenclass.
Выпущенный токен можно протестировать прямо на этом сайте, см. вкладку "Authentication" в боковом меню.
Разрешения токенов
При создании токена можно указать точечные разрешения (scopes). Например, один токен может быть предназначен для создания студентов, а другой для создания заказов. Каждое разрешение относится к группе методов API. Группы вы можете увидеть в боковом меню на этой странице. На данный момент, в Zenclass доступны следующие разрешения:
scope	Пояснение
school	Разрешение для работы с методами из группы "Школа"
student	Разрешение для работы с методами из группы "Студент"
student_course	Разрешение для работы с методами из группы "Студент + Курс"
auto_login_link	Разрешение для работы с методами из группы "Вход"
Формат взаимодействия
Синтаксис запросов и ответов
Все запросы отправляются по https с использованием одного из следующих методов: GET, POST, PUT. API поддерживает запросы с Content-type: application/json. Вот пример запроса с использованием curl:
curl -X GET "https://api.zenclass.net/api/v1/school" \
  -H "Accept: application/json"\
  -H "Authorization: Bearer [TOKEN]" \
В этом примере:
GET это http-метод. У каждого эндпоинта в документации указано, какой метод следует использовать
api.zenclass.net это адрес нашего сервера. В будущем мы оставляем за собой право добавлять новые адреса серверов и отключать старые
api/v1 это префикс, сигнализирующий о том, какую версию API вы используете. В данный момент, доступна только одна версия
school это название метода, который вы вызываете. Названия всех методов есть в соответствующих разделах документации
[TOKEN] это токен, сгенерированный в настройках вашей школы
В ответ на любой запрос сервер вернет либо ответ с кодом 200, либо ошибку с кодами 4xx или 5xx.
Ответ с кодом 200 содержит в себе обязательное поле status со значением true или false и опциональное поле data, внутрь которого уже вложены конкретные данные, уникальные для каждого эндпоинта. Пример успешного ответа:
{
    "status": true,
    "data": {
        "user_id": "...",
        "message": "Ok",
        "example_field": "anything"
    }
}
Ограничения и рекомендации
У методов API Zenclass действует ограничение на количество запросов.
В данный момент, ограничение одинаковое для всех методов: 60 запросов в минуту. Ограничение действует на всю школу целиком. Отдельных лимитов по ключам или IP-адресу нет.
Ответ на любой запрос, вне зависимости от того, вернул он ответ 200 или 4xx, будет содержать два заголовка:
X-RateLimit-Limit: 60 это общее число доступных вам запросов в минуту
X-RateLimit-Remaining: 59 это оставшееся число доступных запросов в текущую минуту
Если вы превысите ограничение, на последующие запросы сервер будет возвращать ответ с http-статусом 429.
Формат ошибок
Общая информация
Любой запрос может вернуть ошибку. Бывают ошибки общего вида, а бывают специфические для конкретного эндпоинта.
Ошибки с http-кодом 5xx означают, что серверу не удалось обработать запрос. Следует повторить попытку позже.
Ошибки с http-кодом 4xx означают, что запрос обработан успешно, поэтому нужно смотреть на конкретный код и тело ответа, чтобы разобраться, что пошло не так. Типовые причины ошибок это неправильный токен, ошибка в URL или входных параметрах.
Пример ответа с ошибкой
// HTTP/1.1 404 Not Found
{
    "status": false,
    "error": {
        "message": "Школа не найдена",
        "code": 100010001
    }
}
Поле message содержит пояснение ошибки, а поле code числовой код, служащий для более точной идентификации ошибки.
Список кодов ошибок
Код	Пояснение
100010001	Школа не найдена
100010002	Операция уже выполняется
100010003	Метод не найден
100010004	Некорректные параметры запроса
100010005	Внутренняя ошибка
100010006	Неопределенная ошибка
100010007	Слишком много запросов в минуту
100010008	Ошибка авторизации
100010009	Логически невозможная операция
100010010	У токена отсутствует разрешение для работы с методом
100020001	Пользователь не найден
100020002	Пользователь отключен
100020003	Этот email уже используется
100020004	Статус не существует
100030001	Студент не подписан на курс
100030002	Студент уже подписан на курс
100030003	Студент уже исключен из курса
100030004	Студент не исключен из курса
100030005	Студент уже записан на курс
100040001	Курс не найден
100050001	Тариф курса не найден
100060001	Текущий тариф не найден
100060002	Тариф уже установлен
100060003	Тариф не присвоен
100060004	Вы превысили лимит студентов
100070001	Студент уже исключен из школы
100070002	Студент не исключен из школы